<%- rss = 'recent?f=' _ c.req.params.f || 'l' %>
<%- title = "Recent" %>
<ul class="nav nav-list slidepanel">
    <li class="visible-phone search">
      <form action="<% IF req.uri.path == '/mirrors'; req.uri.path; ELSE; '/search'; END %>">
        <input type="search" placeholder="Search" name="q"><input type="submit" class="hidden">
      </form>
    </li>
    <li class="nav-header">Activity</li>
    <li><% INCLUDE inc/activity.html query = 'f=' _ c.req.params.f || 'l' %></li>
    <li><a href="/favorite/recent">Recent ++</a></li>
    <li class="divider"></li>
    <li class="nav-header">Filter</li>
    <form action="<% c.uri_for('/recent') %>" method="get" onchange="this.form.submit()">
          <%- filter = { l = 'Latest releases', n = 'New distributions', a = 'Including BackPAN' }; c.req.params.f ||= 'l';
          FOR item IN ['l', 'n']; %>
      <li><label class="radio"><input type="radio" name="f" value="<% item %>"<% IF c.req.params.f == item; ' checked'; END %> onchange="this.form.submit()"> <% filter.${item} %></label></li>
      <% END %>
      <input type="submit" class="hidden">
  </form>
</ul>

<div class="content">
<%-
MoY = [undef, 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
DoW = [undef, "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
releases = [];
FOREACH release IN recent;
date = release.date.dt;
day = "%d %s %s".sprintf(date.day, MoY.item(date.month), date.year);
IF day != last;

IF releases.size; INCLUDE inc/release-table.html releases = releases, header = 1, include_author = 1; END;

releases = [];
IF !loop.first %><br><% END %>
<big>
    <strong class="recent-date">
        <%- USE dt = DateTime( year = date.year, month = date.month, day = date.day ); %>
        <% DoW.item(dt.day_of_week); ", "; day; last = day %>
    </strong>
</big>
<%
END;
releases.push(release);
-%>
<% END %>

<% INCLUDE inc/release-table.html releases = releases, header = 1, include_author = 1 %>
<% INCLUDE inc/pager.html size = 100 %>
</div>
